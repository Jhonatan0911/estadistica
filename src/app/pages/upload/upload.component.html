<div class="flex flex-column align-items-center justify-content-center p-3 md:p-5 mb-3">
  <div class="card w-full md:w-8 p-3 md:p-5 shadow-2">
    <div class="text-center mb-5">
      <h1 class="text-2xl md:text-4xl font-bold text-primary mb-3">Asistente de Análisis Estadístico</h1>
      <p class="text-base md:text-lg text-700 mb-3">Carga información para analizar</p>
      <p class="text-sm md:text-base text-600">Adjunta el archivo Excel bajo la estructura de la plantilla.</p>
    </div>

    <div class="flex justify-content-center mb-4">
      <p-button label="Descargar Plantilla" icon="pi pi-download" (onClick)="descargarPlantilla()" class="p-button-outlined"></p-button>
    </div>

    <div class="w-100 flex justify-content-center flex-wrap">
      <div class="card w-full md:w-6">
        <p-toast />
        <p-fileUpload name="file" url="https://www.primefaces.org/cdn/api/upload.php" [multiple]="false" [fileLimit]="1" accept=".xls,.xlsx" [maxFileSize]="100000000" (onSelect)="onSelectedFiles($event)" [showUploadButton]="false" cancelLabel="Limpiar" chooseLabel="Adjuntar" (onClear)="reset()" (onRemove)="reset()">
            <ng-template pTemplate="content" let-files>
              <div class="flex align-items-center justify-content-center flex-column">
                <i class="pi pi-cloud-upload border-circle p-5 text-8xl text-400 border-400"></i>
                <p class="mt-4 mb-0">Arrastra y suelta archivos aquí para cargar.</p>
              </div>
              <div *ngIf="files?.length > 0">
                <div class="flex flex-wrap p-0 sm:p-5 gap-5">
                  <div *ngFor="let file of files; let i = index" class="card w-full m-0 px-6 flex flex-column border-1 surface-border align-items-center gap-3">
                    <div>
                      <i class="pi pi-file-excel text-6xl text-green-500"></i>
                    </div>
                    <span class="font-semibold">{{ file.name }}</span>
                    <div>{{ formatSize(file.size) }}</div>
                    <p-badge value="Pendiente" severity="warning" />
                  </div>
                </div>
              </div>
            </ng-template>
            <ng-template pTemplate="file">

            </ng-template>
            <ng-template pTemplate="empty">

            </ng-template>
        </p-fileUpload>
        <div class="flex w-full my-3 justify-content-end">
          <p-button label="Cargar" icon="pi pi-save" (onClick)="cargar()" [loading]="loadingCargarExcel" [disabled]="loadingCargarExcel"></p-button>
        </div>
      </div>
    </div>

    <app-excel-preview *ngIf="uploadService.file && uploadService.isCargado" [file]="uploadService.file"></app-excel-preview>


    <div class="flex justify-content-between mt-4">
      <p-button label="Volver" icon="pi pi-arrow-left" (onClick)="router.navigate(['/asistente'])"></p-button>

      <p-button label="Continuar" icon="pi pi-arrow-right" class="p-button-lg" (onClick)="siguiente()"></p-button>
    </div>

  </div>
</div>